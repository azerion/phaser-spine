<html>
<script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
<script src="../node_modules/phaser/build/phaser.js"></script>
<script src="../build/phaser-spine.js"></script>
<script src="./ui.js"></script>
<style>
	* { margin: 0; padding: 0; }
	body, html {
		height: 100%;
		background-color: #4c4c4c;
	}
	canvas { position: absolute; width: 100% ;height: 100%; }
</style>
<body>
	<div style="color: #fff; position: fixed; top: 0; width: 100%">
		<span>Renderer:</span><select id="rendererList">
			<option value="AUTO" selected>Auto</option>
			<option value="CANVAS">Canvas</option>
			<option value="WEBGL">WebGL</option>
		</select>
		<span>Skeleton:</span><select id="skeletonList"></select>
		<span>Animation:</span><select id="animationList"></select>
		<span>Skin:</span><select id="skinList"></select>
		<span>Triangle Rendering:</span><select id="triangleList"><option selected>true</option><option>false</option></select>
		<span>Debug:</span><select id="debugList"><option selected>true</option><option>false</option></select>
	<div>
		<div id="content"></div>
</body>
<script>
var activeSpine;
var spines = {};
var names = ['spineboy-pro', 'goblins', 'raptor', 'stretchyman', 'tank', 'vine', 'buddy'];

var game = new Phaser.Game({
	width: window.innerWidth,
	height: window.innerWidth / 4 * 3,
	renderer: Phaser[location.href.split('?')[1]] || Phaser.AUTO,
	parent: 'content',
	transparent: true,
	state: {
		preload: preload,
		create: create,
		render: render
	}
});

function preload() {
	game.plugins.add(PhaserSpine.SpinePlugin, {
		debugRendering: true,
		triangleRendering: true
	});
	game.stage.disableVisibilityChange = true;

	names.forEach(function (name) {
		game.load.spine(name, 'assets/' + name + '.json');
	});
	game.load.image('btn', 'assets/btn_01.png');
}

function create() {
	var g = game.add.graphics(0, 0);
	g.lineStyle(2, 0xFFFFFF, 1)
		.moveTo(this.game.width  / 2, 0)
		.lineTo(this.game.width  / 2, this.game.height)
		.moveTo(0, this.game.height / 2)
		.lineTo(this.game.width, this.game.height / 2);

	//Add button BEFORE spine to show depth
	game.add.image(game.width / 2 - 104, game.height / 2, 'btn');

	names.forEach(function (name, index) {
		let spine = game.add.spine(game.width / 2, game.height / 2, name);
		spine.anchor.set(0.5);
		spine.scale.set(0.5);
		spine.visible = false;
		spine.state.setAnimation(0, spine.state.data.skeletonData.animations[0].name, true);

		spines[name] = spine;
	});

	activeSpine = 'spineboy-pro';
	spines[activeSpine].visible = true;

	//Add button AFTER spine to show depth
	game.add.image(game.width / 2, game.height / 2, 'btn');

	setupUI();
}

function render() {
	if (activeSpine && PhaserSpine.SpinePlugin.DEBUG) {
		game.debug.spriteBounds(spines[activeSpine]);
		game.debug.spriteInfo(spines[activeSpine], 20, 20);
	}
}
</script>
</html>